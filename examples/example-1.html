<style>

canvas {
  background: #ddd;
  border: 1px solid black;
  position: absolute;
  top: 50px;
  left: 50px;
}

</style>

<a href="index.html">Back to examples</a><br>
<canvas id="example"></canvas>

<script src="../build/index.js"></script>
<script src="debug.js"></script>
<script>

const canvas = document.getElementById('example');
const context = canvas.getContext('2d');

const Debug = window.default;
Debug.initialise();

function resizeCanvas() {
  canvas.width = window.innerWidth - 100;
  canvas.height = window.innerHeight - 100;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// Create a dock layout with panels in different positions
const layout = new Layout({
  root: {
    id: 'root',
    type: 'dock',
    padding: { x: '20px', y: '20px' },
    topLeft: {
      id: 'menu',
      type: 'leaf',
      size: { x: '200px', y: '100px' },
    },
    topRight: {
      id: 'minimap',
      type: 'leaf',
      size: { x: '20%' },
      aspectRatio: 1,
      minSize: { x: '100px', y: '100px' },
    },
    center: {
      id: 'gameplay',
      type: 'leaf',
      size: { x: '60%', y: '70%' },
      minSize: { x: '300px', y: '200px' },
      maxSize: { x: '800px', y: '600px' },
    },
    bottomLeft: {
      id: 'inventory',
      type: 'leaf',
      size: { x: '180px', y: '120px' },
      offset: { x: '0px', y: '-80px' },
    },
    bottomCenter: {
      id: 'actions',
      type: 'leaf',
      size: { x: 'auto', y: '80px' },
    },
  },
});

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

function update() {
  layout.update({ x: canvas.width, y: canvas.height });
}

function draw() {
  context.clearRect(0, 0, canvas.width, canvas.height);

  // Draw layout node borders and labels
  const nodeIds = layout.getNodeIds();
  nodeIds.forEach(id => {
    const node = layout.get(id);
    if (node && node.visible) {
      // Draw border
      Debug.border(
        id,
        '',
        { x: node.left, y: node.top },
        {
          showValue: false,
          size: { x: node.width, y: node.height },
          borderColour: getNodeColor(id),
          borderWidth: 2,
        }
      );

      // Draw center marker
      Debug.marker(`${id}-center`, id, node.center, {
        showValue: false,
        markerColour: getNodeColor(id),
        markerStyle: '+',
        markerSize: 8,
      });
    }
  });

  Debug.draw(context);
}

function getNodeColor(id) {
  const colors = {
    root: '#666',
    menu: '#ff6b6b',
    minimap: '#4ecdc4',
    gameplay: '#45b7d1',
    inventory: '#f9ca24',
    actions: '#f0932b',
  };
  return colors[id] || '#ccc';
}

// Start the animation loop
loop();

</script>
